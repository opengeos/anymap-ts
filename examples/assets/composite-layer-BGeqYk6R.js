import{H as A,ap as C,g as R,aq as v}from"./mapbox-overlay-C46bI65L.js";const E="compositeLayer.renderLayers";class U extends A{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||t}getSubLayerRow(e,t,r){return e.__source={parent:this,object:t,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const t={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(t.index=r.__source.index,e(r.__source.object,t)):e(r,i)}return e}getSubLayerProps(e={}){var c;const{opacity:t,pickable:r,visible:i,parameters:o,getPolygonOffset:h,highlightedObjectIndex:l,autoHighlight:b,highlightColor:L,coordinateSystem:_,coordinateOrigin:S,wrapLongitude:f,positionFormat:T,modelMatrix:m,extensions:g,fetch:j,operation:x,_subLayerProps:d}=this.props,a={id:"",updateTriggers:{},opacity:t,pickable:r,visible:i,parameters:o,getPolygonOffset:h,highlightedObjectIndex:l,autoHighlight:b,highlightColor:L,coordinateSystem:_,coordinateOrigin:S,wrapLongitude:f,positionFormat:T,modelMatrix:m,extensions:g,fetch:j,operation:x},s=d&&e.id&&d[e.id],P=s&&s.updateTriggers,O=e.id||"sublayer";if(s){const p=this.props[C],n=e.type?e.type._propTypes:{};for(const u in s){const y=n[u]||p[u];y&&y.type==="accessor"&&(s[u]=this.getSubLayerAccessor(s[u]))}}Object.assign(a,e,s),a.id=`${this.props.id}-${O}`,a.updateTriggers={all:(c=this.props.updateTriggers)==null?void 0:c.all,...e.updateTriggers,...P};for(const p of g){const n=p.getSubLayerProps.call(this,p);n&&Object.assign(a,n,{updateTriggers:Object.assign(a.updateTriggers,n.updateTriggers)})}return a}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const o=this.renderLayers();r=R(o,Boolean),this.internalState.subLayers=r}v(E,this,i,r);for(const o of r)o.parent=this}}U.layerName="CompositeLayer";export{U as C};
