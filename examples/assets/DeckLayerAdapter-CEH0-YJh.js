class r{type="deck";static LAYER_PREFIXES=["scatterplot-","arc-","path-","polygon-","hexagon-","heatmap-","grid-","icon-","text-","geojson-","contour-","screengrid-","pointcloud-","trips-","line-","cog-","bitmap-","column-","gridcell-","solidpolygon-","tile-","mvt-","tile3d-","terrain-","greatcircle-","h3hexagon-","h3cluster-","s2-","quadkey-","geohash-","wms-","simplemesh-","scenegraph-","lidar-"];map;deckOverlay;deckLayers;changeCallbacks=[];constructor(t,s,e){this.map=t,this.deckOverlay=s,this.deckLayers=e}getLayerIds(){return Array.from(this.deckLayers.keys())}getLayerState(t){const s=this.deckLayers.get(t);return!s||!s.props?null:{visible:s.props.visible!==!1,opacity:s.props.opacity??1,name:this.getName(t)}}setVisibility(t,s){const e=this.deckLayers.get(t);if(!e||typeof e.clone!="function")return;const i=e.clone({visible:s});this.deckLayers.set(t,i),this.updateOverlay()}setOpacity(t,s){const e=this.deckLayers.get(t);if(!e||typeof e.clone!="function")return;const i=e.clone({opacity:s});this.deckLayers.set(t,i),this.updateOverlay()}getName(t){for(const s of r.LAYER_PREFIXES)if(t.startsWith(s)){const e=t.slice(s.length);if(!e||/^\d+$/.test(e)){const i=s.slice(0,-1);return i.charAt(0).toUpperCase()+i.slice(1)+" Layer"}return e.replace(/[-_]/g," ").replace(/\b\w/g,i=>i.toUpperCase())}return t}getSymbolType(t){return t.startsWith("scatterplot-")||t.startsWith("pointcloud-")||t.startsWith("icon-")||t.startsWith("lidar-")?"circle":t.startsWith("arc-")||t.startsWith("line-")||t.startsWith("path-")||t.startsWith("trips-")||t.startsWith("greatcircle-")?"line":t.startsWith("polygon-")||t.startsWith("hexagon-")||t.startsWith("grid-")||t.startsWith("geojson-")||t.startsWith("solidpolygon-")||t.startsWith("gridcell-")||t.startsWith("h3hexagon-")||t.startsWith("h3cluster-")||t.startsWith("s2-")||t.startsWith("quadkey-")||t.startsWith("geohash-")?"fill":t.startsWith("heatmap-")||t.startsWith("screengrid-")||t.startsWith("contour-")?"heatmap":t.startsWith("text-")?"symbol":t.startsWith("cog-")||t.startsWith("bitmap-")||t.startsWith("tile-")||t.startsWith("wms-")||t.startsWith("terrain-")?"raster":t.startsWith("mvt-")?"fill":t.startsWith("column-")||t.startsWith("tile3d-")||t.startsWith("simplemesh-")||t.startsWith("scenegraph-")?"fill-extrusion":"deck"}notifyLayerAdded(t){this.changeCallbacks.forEach(s=>s("add",t))}notifyLayerRemoved(t){this.changeCallbacks.forEach(s=>s("remove",t))}onLayerChange(t){return this.changeCallbacks.push(t),()=>{const s=this.changeCallbacks.indexOf(t);s>=0&&this.changeCallbacks.splice(s,1)}}updateOverlay(){const t=Array.from(this.deckLayers.values());this.deckOverlay.setProps({layers:t}),this.map.triggerRepaint()}}export{r as D};
