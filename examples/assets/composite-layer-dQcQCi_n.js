import{L as O,P as A,f as C,a as R}from"./mapbox-overlay-CjL5nCza.js";const v="compositeLayer.renderLayers";class E extends O{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||t}getSubLayerRow(e,t,r){return e.__source={parent:this,object:t,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const t={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(t.index=r.__source.index,e(r.__source.object,t)):e(r,i)}return e}getSubLayerProps(e={}){const{opacity:t,pickable:r,visible:i,parameters:o,getPolygonOffset:y,highlightedObjectIndex:h,autoHighlight:l,highlightColor:L,coordinateSystem:b,coordinateOrigin:_,wrapLongitude:S,positionFormat:f,modelMatrix:T,extensions:d,fetch:m,operation:P,_subLayerProps:g}=this.props,a={id:"",updateTriggers:{},opacity:t,pickable:r,visible:i,parameters:o,getPolygonOffset:y,highlightedObjectIndex:h,autoHighlight:l,highlightColor:L,coordinateSystem:b,coordinateOrigin:_,wrapLongitude:S,positionFormat:f,modelMatrix:T,extensions:d,fetch:m,operation:P},s=g&&e.id&&g[e.id],j=s&&s.updateTriggers,x=e.id||"sublayer";if(s){const p=this.props[A],n=e.type?e.type._propTypes:{};for(const u in s){const c=n[u]||p[u];c&&c.type==="accessor"&&(s[u]=this.getSubLayerAccessor(s[u]))}}Object.assign(a,e,s),a.id=`${this.props.id}-${x}`,a.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...j};for(const p of d){const n=p.getSubLayerProps.call(this,p);n&&Object.assign(a,n,{updateTriggers:Object.assign(a.updateTriggers,n.updateTriggers)})}return a}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const o=this.renderLayers();r=C(o,Boolean),this.internalState.subLayers=r}R(v,this,i,r);for(const o of r)o.parent=this}}E.layerName="CompositeLayer";export{E as C};
